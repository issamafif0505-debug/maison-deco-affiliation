---
import { buildAmazonLink } from '../../utils/affiliate';

interface Props {
  asin: string;
  tag?: string;
  text?: string;
  size?: 'small' | 'medium' | 'large';
}

const { asin, tag = 'issamdeco-21', text = 'Voir le prix sur Amazon', size = 'medium' } = Astro.props;

const url = buildAmazonLink(asin, tag);

const sizeClasses = {
  small: 'px-4 py-2.5 text-sm',
  medium: 'px-6 py-3.5 text-base',
  large: 'px-8 py-4 text-lg w-full',
};
---

<a
  href={url}
  rel="nofollow sponsored noopener"
  target="_blank"
  class:list={[
    'btn-amazon',
    sizeClasses[size],
  ]}
>
  <!-- Amazon logo -->
  <svg class="w-5 h-5 flex-shrink-0" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
    <path d="M13.958 10.09c0 1.232.029 2.256-.591 3.351-.502.891-1.301 1.438-2.186 1.438-1.214 0-1.922-.924-1.922-2.292 0-2.692 2.415-3.182 4.699-3.182v.685zm3.186 7.705c-.209.189-.512.201-.745.074-1.052-.872-1.238-1.276-1.814-2.106-1.734 1.767-2.962 2.297-5.209 2.297-2.66 0-4.731-1.641-4.731-4.925 0-2.565 1.391-4.309 3.37-5.164 1.715-.754 4.11-.891 5.942-1.097v-.41c0-.753.06-1.642-.384-2.294-.385-.579-1.124-.82-1.775-.82-1.205 0-2.277.618-2.54 1.898-.054.285-.261.567-.547.582l-3.065-.331c-.259-.056-.545-.27-.472-.669.704-3.716 4.06-4.838 7.066-4.838 1.537 0 3.547.41 4.758 1.574 1.538 1.436 1.391 3.352 1.391 5.438v4.923c0 1.479.616 2.13 1.192 2.929.204.287.249.63-.012.844-.647.541-1.794 1.537-2.425 2.095l-.001-.001z"/>
  </svg>
  <span>{text}</span>
  <svg class="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
  </svg>
</a>
