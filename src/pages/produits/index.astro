---
import BaseLayout from '../../layouts/BaseLayout.astro';
import ProductGrid from '../../components/product/ProductGrid.astro';
import Breadcrumbs from '../../components/common/Breadcrumbs.astro';
import { getCollection } from 'astro:content';
import categories from '../../data/categories.json';

const allProducts = await getCollection('products');
const sortedProducts = allProducts.sort((a, b) => {
  if (a.data.featured && !b.data.featured) return -1;
  if (!a.data.featured && b.data.featured) return 1;
  return b.data.rating.score - a.data.rating.score;
});
---

<BaseLayout
  title="Tous les produits"
  description="Decouvrez notre selection des meilleurs produits maison et decoration. Compares, testes et approuves."
>
  <div class="container-custom py-8 md:py-12">
    <Breadcrumbs items={[{ label: 'Produits' }]} />

    <div class="max-w-3xl mb-10">
      <h1 class="font-serif text-4xl md:text-5xl font-bold text-gray-900 mb-4">
        Nos produits selectionnes
      </h1>
      <p class="text-lg text-gray-600">
        Chaque produit est soigneusement selectionne et teste. Cliquez pour voir notre avis detaille et acheter sur Amazon.
      </p>
    </div>

    {sortedProducts.length > 0 ? (
      <ProductGrid products={sortedProducts} columns={3} />
    ) : (
      <div class="text-center py-20">
        <span class="text-6xl mb-4 block">ðŸ›’</span>
        <h2 class="font-serif text-2xl font-bold text-gray-900 mb-2">Aucun produit pour le moment</h2>
        <p class="text-gray-600">Les premiers produits arrivent bientot !</p>
      </div>
    )}
  </div>
</BaseLayout>
